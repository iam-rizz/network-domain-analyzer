# =============================================================================
# Network & Domain Analyzer - Backend Configuration
# =============================================================================
# Copy this file to .env and configure for your environment
# For production, ensure all security-related variables are properly set
# =============================================================================

# -----------------------------------------------------------------------------
# Server Configuration
# -----------------------------------------------------------------------------
# Environment: development, production, test
NODE_ENV=development

# Server port
PORT=5000

# API base URL (used for generating links)
API_BASE_URL=http://localhost:5000

# -----------------------------------------------------------------------------
# Database Configuration
# -----------------------------------------------------------------------------
# SQLite (development) - relative path from backend directory
DATABASE_URL=./data/analyses.db

# PostgreSQL (production) - uncomment and configure for production
# DATABASE_URL=postgresql://user:password@localhost:5432/netanalyzer

# Connection pool settings (PostgreSQL only)
DATABASE_POOL_MIN=2
DATABASE_POOL_MAX=10

# -----------------------------------------------------------------------------
# Redis Configuration (Optional)
# -----------------------------------------------------------------------------
# Redis is used for:
# - Rate limiting (distributed)
# - Caching DNS/WHOIS results
# - Session storage (if needed)

# Redis connection URL
REDIS_URL=redis://localhost:6379

# Enable/disable Redis (falls back to in-memory if disabled or unavailable)
REDIS_ENABLED=false

# Redis password (if authentication is required)
# REDIS_PASSWORD=your-redis-password

# -----------------------------------------------------------------------------
# Security Configuration
# -----------------------------------------------------------------------------
# IMPORTANT: Generate strong secrets for production!
# Use: openssl rand -hex 32

# Secret for API key generation and validation
API_KEY_SECRET=your-secret-key-here-change-in-production

# CORS allowed origins (comma-separated)
# For production, specify exact origins - never use * in production
ALLOWED_ORIGINS=http://localhost:3000,http://localhost:5173

# -----------------------------------------------------------------------------
# Rate Limiting Configuration
# -----------------------------------------------------------------------------
# Global rate limit window in milliseconds (default: 15 minutes)
RATE_LIMIT_WINDOW_MS=900000

# Maximum requests per window (default: 100)
RATE_LIMIT_MAX_REQUESTS=100

# Endpoint-specific rate limits (requests per 15 minutes)
RATE_LIMIT_DNS=50
RATE_LIMIT_RDAP=50
RATE_LIMIT_WHOIS=30
RATE_LIMIT_HOST=50
RATE_LIMIT_IP=100
RATE_LIMIT_BATCH=5
RATE_LIMIT_HISTORY=100

# -----------------------------------------------------------------------------
# External API Configuration
# -----------------------------------------------------------------------------
# IP Geolocation API (optional - for enhanced IP lookup)
# Supported providers: ipapi, ipinfo, ipstack
IP_GEOLOCATION_PROVIDER=ipapi
IP_GEOLOCATION_API_KEY=your-api-key-here

# -----------------------------------------------------------------------------
# Timeout Configuration (milliseconds)
# -----------------------------------------------------------------------------
# DNS lookup timeout
TIMEOUT_DNS=5000

# WHOIS query timeout
TIMEOUT_WHOIS=10000

# HTTP check timeout
TIMEOUT_HTTP=10000

# Ping test timeout
TIMEOUT_PING=5000

# Port scan timeout (per port)
TIMEOUT_PORT_SCAN=30000

# SSL check timeout
TIMEOUT_SSL=10000

# IP lookup timeout
TIMEOUT_IP=5000

# External API timeout (max)
TIMEOUT_EXTERNAL_API=30000

# RDAP query timeout
TIMEOUT_RDAP=10000

# -----------------------------------------------------------------------------
# Cache Configuration (TTL in seconds)
# -----------------------------------------------------------------------------
# DNS results cache TTL (default: 5 minutes)
CACHE_TTL_DNS=300

# WHOIS results cache TTL (default: 24 hours)
CACHE_TTL_WHOIS=86400

# IP geolocation cache TTL (default: 1 hour)
CACHE_TTL_IP=3600

# SSL certificate cache TTL (default: 1 hour)
CACHE_TTL_SSL=3600

# RDAP results cache TTL (default: 24 hours)
CACHE_TTL_RDAP=86400

# -----------------------------------------------------------------------------
# History Configuration
# -----------------------------------------------------------------------------
# Maximum history entries to keep (oldest are auto-deleted)
HISTORY_MAX_ENTRIES=100

# -----------------------------------------------------------------------------
# Batch Processing Configuration
# -----------------------------------------------------------------------------
# Maximum domains per batch request
BATCH_MAX_DOMAINS=50

# Concurrent batch processing limit
BATCH_CONCURRENCY=5

# -----------------------------------------------------------------------------
# Logging Configuration
# -----------------------------------------------------------------------------
# Log level: error, warn, info, http, verbose, debug, silly
LOG_LEVEL=info

# Log file directory (relative to backend directory)
LOG_DIR=./logs

# Maximum log file size before rotation (bytes)
LOG_MAX_SIZE=10485760

# Maximum number of log files to keep
LOG_MAX_FILES=5

# -----------------------------------------------------------------------------
# RDAP Configuration
# -----------------------------------------------------------------------------
# Path to RDAP bootstrap file (relative to project root)
RDAP_BOOTSTRAP_FILE=./dns.json

# -----------------------------------------------------------------------------
# Request Limits
# -----------------------------------------------------------------------------
# Maximum request body size (bytes) - default 1MB
REQUEST_MAX_SIZE=1048576

# -----------------------------------------------------------------------------
# DNS Propagation Check Configuration
# -----------------------------------------------------------------------------
# Minimum probe locations for propagation check
DNS_PROPAGATION_MIN_LOCATIONS=5

# -----------------------------------------------------------------------------
# Host Monitoring Configuration
# -----------------------------------------------------------------------------
# Minimum probe locations for availability check
HOST_MONITOR_MIN_LOCATIONS=3

# Slow response threshold (milliseconds)
HOST_SLOW_RESPONSE_THRESHOLD=5000

# -----------------------------------------------------------------------------
# SSL Certificate Configuration
# -----------------------------------------------------------------------------
# Days before expiry to show warning
SSL_EXPIRY_WARNING_DAYS=30

# -----------------------------------------------------------------------------
# Domain Expiration Configuration
# -----------------------------------------------------------------------------
# Days before expiry to show renewal reminder
DOMAIN_EXPIRY_REMINDER_DAYS=60
